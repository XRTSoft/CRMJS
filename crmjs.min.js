var crmjs=function(){function t(n){return n===null||n===undefined}var n=Xrm;return{FORM_TYPE_CREATE:1,FORM_TYPE_UPDATE:2,FORM_TYPE_READ_ONLY:3,FORM_TYPE_DISABLED:4,FORM_TYPE_BULK_EDIT:6,FORM_TYPE_READ_OPTIMIZED:11,isNullOrUndefined:function(n){return n===null||n===undefined},isNullOrUndefinedOrEmptyString:function(n){var i=t(n);return i?i:i===""},init:function(){},utils:{openDialog:function(n,t,i){var r="/cs/dialog/rundialog.aspx?DialogId="+n+"&EntityName="+t+"&ObjectId="+i;window.open(r)},openDialogByName:function(n,t,i){crmjs.webAPI.filter("workflows","name eq '"+n+"' and parentworkflowid/workflowid eq null and statecode eq 2","name",function(n){var r="/cs/dialog/rundialog.aspx?DialogId="+n.workflowid+"&EntityName="+t+"&ObjectId="+i;window.open(r)})}},webAPI:{fixId:function(n){return n=crmjs.isNullOrUndefined(n)?"":n,n=n.replace("{",""),n.replace("}","")},getByUrl:function(n,t){var i=new XMLHttpRequest;i.open("get",n,!0);i.setRequestHeader("OData-MaxVersion","4.0");i.setRequestHeader("OData-Version","4.0");i.setRequestHeader("Prefer",'odata.include-annotations="*"');i.onreadystatechange=function(){this.readyState==4&&(i.onreadystatechange=null,t!==null&&typeof t=="function"&&t(JSON.parse(this.responseText)))};i.send()},filter:function(n,t,i,r){var u="/api/data/v8.2/"+n+"/";u+="?filter="+t+"&";u+="$select="+i;crmjs.webAPI.getByUrl(u,r)},byId:function(n,t,i,r){var u="/api/data/v8.2/"+n+"("+crmjs.webAPI.fixId(t)+")";u+="?$select="+i;crmjs.webAPI.getByUrl(u,r)}},attr:{get:function(i){var r=n.Page.getAttribute(i);if(t(r))throw"attributes.get - no attribute found with name: "+i;return r},getControl:function(i){var r=n.Page.getControl(i);if(t(r))throw"attributes.getControl - no control found with name: "+i;return r},getValue:function(n){var t=crmjs.attr.get(n);return t.getValue()},getCurrentValue:function(n){var t=crmjs.attr.getControl(n);return t.getValue()},setValue:function(n,t){var i=crmjs.attr.get(n);try{i.setValue(t)}catch(r){throw"attr.setValue ("+n+") - Exception: "+r.message;}},setLookupValue:function(n,t,i,r){var f=crmjs.attr.get(n),u;try{u=[];u[0]={};u[0].id=t;u[0].name=i;u[0].entityType=r;f.setValue(u)}catch(e){throw"attr.setLookupValue ("+n+") - Exception: "+e.message;}},getDisabled:function(n){var t=crmjs.attr.getControl(n);return t.getDisabled()},setDisabled:function(n,t){var i=crmjs.attr.getControl(n);i.setDisabled(t)},getVisible:function(n){var t=crmjs.attr.getControl(n);return t.getVisible()},setVisible:function(n,t){var i=crmjs.attr.getControl(n);i.setVisible(t)},setRequired:function(n,t){var i=crmjs.attr.get(n);t?i.setRequiredLevel("required"):i.setRequiredLevel("none")},getLabel:function(n){var t=crmjs.attr.getControl(n);return t.getLabel()},setLabel:function(n,t){var i=crmjs.attr.getControl(n);i.setLabel(t)},addOnChange:function(n,t,i){var r=crmjs.attr.get(n);r.addOnChange(t);i&&r.fireOnChange()}},grids:{refresh:function(n){var t=crmjs.attr.getControl(n);t.refresh()},get:function(n){var t=crmjs.attr.getControl(n);return t.getGrid()},getEntityName:function(n){var t=crmjs.attr.getControl(n);return t.getEntityName()},addOnLoad:function(n,t){var i=crmjs.attr.getControl(n);i.addOnLoad(t)}},form:{getLabel:function(){var t=n.Page.ui.formSelector.getCurrentItem();return t===null?"":t.getLabel()},getEntityId:function(){return n.Page.data.entity.getId()},getEntityName:function(){return n.Page.data.entity.getEntityName()},getFormType:function(){return n.Page.ui.getFormType()},addOnSave:function(t){n.Page.data.entity.addOnSave(t)},removeOnSave:function(t){n.Page.data.entity.removeOnSave(t)},close:function(){xrmvr.Page.ui.close()},refreshRibbon:function(){n.Page.ui.refreshRibbon()},quickForm:{get:function(i){var r=n.Page.ui.quickForm.get(i);if(t(r))throw"attributes.get - no quickview form found with name: "+i;return r},getWhenLoaded:function(t){var i=n.form.quickForm.get(t);if(i.isLoaded())return i;window.setTimeout(n.forms.quickForm.get(t),100)}},tab:{get:function(i){var r=n.Page.ui.tabs.get(i);if(t(r))throw"form.getTab - no tab found with name: "+i;return r},isCollapsed:function(n){var t=crmjs.form.tab.get(n);return t.getDisplayState()==="collapsed"},collapse:function(n){var t=crmjs.form.tab.get(n);return t.setDisplayState("collapsed")},expand:function(n){var t=crmjs.form.tab.get(n);return t.setDisplayState("expanded")},getLabel:function(n){var t=crmjs.form.tab.get(n);return t.getLabel()},setLabel:function(n,t){var i=crmjs.form.tab.get(n);return i.setLabel(t)},getVisible:function(n){var t=crmjs.form.tab.get(n);return t.getVisible()},setVisible:function(n,t){var i=crmjs.form.tab.get(n);return i.setVisible(t)}},section:{get:function(i){var u=n.Page.ui.tabs.getAll(),r,f;if(u===null||u.length<1)throw"form.getSection - no tabs found on form to use to find section: "+i;for(r=null,f=0;f<u.length;f++)if(r=u[f].sections.getByName(i),r!==null)break;if(t(r))throw"form.getSection - no section found with name: "+i;return r},getLabel:function(n){var t=crmjs.form.section.get(n);return t.getLabel()},setLabel:function(n,t){var i=crmjs.form.section.get(n);return i.setLabel(t)},getVisible:function(n){var t=crmjs.form.section.get(n);return t.getVisible()},setVisible:function(n,t){var i=crmjs.form.section.get(n);return i.setVisible(t)}}},navItems:{get:function(i){var r=n.Page.ui.navigation.items(i);if(t(r))throw"navItems.get - no nav item found with name: "+i;return r},setLabel:function(n,t){var i=crmjs.navItems.get(n);i.setLabel(t)},getVisible:function(n){var t=crmjs.navItems.get(n);t.getVisible()},setVisible:function(n,t){var i=crmjs.navItems.get(n);i.setVisible(t)}},events:{refresh:function(t,i,r){n.Page.data.refresh(save).then(i,r)},save:function(t,i){n.Page.data.save().then(t,i)},saveAndClose:function(){n.Page.data.entity.save("saveandclose")},saveAndNew:function(){n.Page.data.entity.save("saveandnew")}},notificatons:{set:function(t,i,r){n.Page.ui.setFormNotification(t,i,r)},clear:function(t){n.Page.ui.clearFormNotification(t)},fieldSet:function(n,t,i){var r=crmjs.attr.getControl(n);r.setNotification(t,i)},fieldClear:function(n,t){var i=crmjs.attr.getControl(n);i.clearNotification(t)}},iframe:{getSrc:function(n){var t=crmjs.attr.getControl(n);return t.getSrc()},setSrc:function(n,t){var i=crmjs.attr.getControl(n);return i.setSrc(t)},get:function(){var n=crmjs.attr.getControl(iFrameName);return n.getObject()}},debug:{log:function(n){(typeof console=="undefined"||typeof console.log=="undefined")&&(console={},console.log=function(n){alert(n)});console.log("debug: "+n)}},processes:{getId:function(){var t=n.Page.data.process.getActiveProcess();return t===null?null:t.getId()},getName:function(){var t=n.Page.data.process.getActiveProcess();return t===null?null:t.getName()},getStages:function(){var t=n.Page.data.process.getActiveProcess();return t===null?null:t.getStages()},stage:{active:{getName:function(){var t=n.Page.data.process.getActiveStage();return t.getName()},getStatus:function(){var t=n.Page.data.process.getActiveStage();return t.getStatus()},getId:function(){var t=n.Page.data.process.getActiveStage();return t.getId()},getCategory:function(){var t=n.Page.data.process.getActiveStage();return t.getCategory()===null?"":t.getCategory().getValue()},getSteps:function(){var t=n.Page.data.process.getActiveStage();return t.getSteps()}},selected:{getName:function(){var t=n.Page.data.process.getSelectedStage();return t.getName()},getStatus:function(){var t=n.Page.data.process.getSelectedStage();return t.getStatus()},getId:function(){var t=n.Page.data.process.getSelectedStage();return t.getId()},getCategory:function(){var t=n.Page.data.process.getSelectedStage();return t.getCategory()===null?"":t.getCategory().getValue()},getSteps:function(){var t=n.Page.data.process.getSelectedStage();return t.getSteps()}}},addOnChange:function(t){n.Page.data.process.addOnStageChange(t)},addOnSelected:function(t){n.Page.data.process.addOnStageSelected(t)},addOnStatusChanged:function(t){n.Page.data.process.addOnProcessStatusChange(t)},moveNext:function(t){n.Page.data.process.moveNext(t)},movePrevious:function(t){n.Page.data.process.movePrevious(t)}}}}();