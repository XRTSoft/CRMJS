var crmjs=function(){function i(n){return n===null||n===undefined}var n=Xrm,t=!0;return{FORM_TYPE_CREATE:1,FORM_TYPE_UPDATE:2,FORM_TYPE_READ_ONLY:3,FORM_TYPE_DISABLED:4,FORM_TYPE_BULK_EDIT:6,FORM_TYPE_READ_OPTIMIZED:11,isNullOrUndefined:function(n){return n===null||n===undefined},isNullOrUndefinedOrEmptyString:function(n){var t=i(n);return t?t:t===""},init:function(){},webAPI:{fixId:function(n){return n=crmjs.isNullOrUndefined(n)?"":n,n=n.replace("{",""),n.replace("}","")},getByUrl:function(n,t){var i=new XMLHttpRequest;i.open("get",n,!0);i.setRequestHeader("OData-MaxVersion","4.0");i.setRequestHeader("OData-Version","4.0");i.setRequestHeader("Prefer",'odata.include-annotations="*"');i.onreadystatechange=function(){this.readyState==4&&(i.onreadystatechange=null,t!==null&&typeof t=="function"&&t(JSON.parse(this.responseText)))};i.send()},filter:function(n,t,i,r){var u="/api/data/v8.2/"+n+"/";u+="?filter="+t+"&";u+="$select="+i;crmjs.webAPI.getByUrl(u,r)},byId:function(n,t,i,r){var u="/api/data/v8.2/"+n+"("+crmjs.webAPI.fixId(t)+")";u+="?$select="+i;crmjs.webAPI.getByUrl(u,r)}},attr:{get:function(r){var u=n.Page.getAttribute(r);if(t&&i(u))throw"attributes.get - no attribute found with name: "+r;return u},getControl:function(r){var u=n.Page.getControl(r);if(t&&i(u))throw"attributes.getControl - no control found with name: "+r;return u},getValue:function(n){var t=crmjs.attr.get(n);return t.getValue()},getCurrentValue:function(n){var t=crmjs.attr.getControl(n);return t.getValue()},setValue:function(n,i){var u=crmjs.attr.get(n);try{u.setValue(i)}catch(r){if(t)throw"attr.setValue ("+n+") - Exception: "+r.message;else throw r;}},setLookupValue:function(n,i,r,u){var o=crmjs.attr.get(n),f;try{f=[];f[0]={};f[0].id=i;f[0].name=r;f[0].entityType=u;o.setValue(f)}catch(e){if(t)throw"attr.setLookupValue ("+n+") - Exception: "+e.message;else throw e;}},getDisabled:function(n){var t=crmjs.attr.getControl(n);return t.getDisabled()},setDisabled:function(n,t){var i=crmjs.attr.getControl(n);i.setDisabled(t)},getVisible:function(n){var t=crmjs.attr.getControl(n);return t.getVisible()},setVisible:function(n,t){var i=crmjs.attr.getControl(n);i.setVisible(t)},setRequired:function(n,t){var i=crmjs.attr.get(n);t?i.setRequiredLevel("required"):i.setRequiredLevel("none")},getLabel:function(n){var t=crmjs.attr.getControl(n);return t.getLabel()},setLabel:function(n,t){var i=crmjs.attr.getControl(n);i.setLabel(t)}},grids:{refresh:function(n){var t=crmjs.attr.getControl(n);t.refresh()},get:function(n){var t=crmjs.attr.getControl(n);return t.getGrid()},getEntityName:function(n){var t=crmjs.attr.getControl(n);return t.getEntityName()},addOnLoad:function(n,t){var i=crmjs.attr.getControl(n);i.addOnLoad(t)}},form:{getLabel:function(){var t=n.Page.ui.formSelector.getCurrentItem();return t===null?"":t.getLabel()},getEntityId:function(){return n.Page.data.entity.getId()},getEntityName:function(){return n.Page.data.entity.getEntityName()},getFormType:function(){return n.Page.ui.getFormType()},addOnSave:function(t){n.Page.data.entity.addOnSave(t)},removeOnSave:function(t){n.Page.data.entity.removeOnSave(t)},close:function(){xrmvr.Page.ui.close()},refreshRibbon:function(){n.Page.ui.refreshRibbon()},quickForm:{get:function(r){var u=n.Page.ui.quickForm.get(r);if(t&&i(u))throw"attributes.get - no quickview form found with name: "+r;return u},getWhenLoaded:function(t){var i=n.form.quickForm.get(t);if(i.isLoaded())return i;window.setTimeout(n.forms.quickForm.get(t),100)}},tab:{get:function(r){var u=n.Page.ui.tabs.get(r);if(t&&i(u))throw"form.getTab - no tab found with name: "+r;return u},isCollapsed:function(n){var t=crmjs.form.tab.get(n);return t.getDisplayState()==="collapsed"},collapse:function(n){var t=crmjs.form.tab.get(n);return t.setDisplayState("collapsed")},expand:function(n){var t=crmjs.form.tab.get(n);return t.setDisplayState("expanded")},getLabel:function(n){var t=crmjs.form.tab.get(n);return t.getLabel()},setLabel:function(n,t){var i=crmjs.form.tab.get(n);return i.setLabel(t)},getVisible:function(n){var t=crmjs.form.tab.get(n);return t.getVisible()},setVisible:function(n,t){var i=crmjs.form.tab.get(n);return i.setVisible(t)}},section:{get:function(r){var f=n.Page.ui.tabs.getAll(),u,e;if((f===null||f.length<1)&&t)throw"form.getSection - no tabs found on form to use to find section: "+r;for(u=null,e=0;e<f.length;e++)if(u=f[e].sections.getByName(r),u!==null)break;if(t&&i(u))throw"form.getSection - no section found with name: "+r;return u},getLabel:function(n){var t=crmjs.form.section.get(n);return t.getLabel()},setLabel:function(n,t){var i=crmjs.form.section.get(n);return i.setLabel(t)},getVisible:function(n){var t=crmjs.form.section.get(n);return t.getVisible()},setVisible:function(n,t){var i=crmjs.form.section.get(n);return i.setVisible(t)}}},navItems:{get:function(r){var u=n.Page.ui.navigation.items(r);if(t&&i(u))throw"navItems.get - no nav item found with name: "+r;return u},setLabel:function(n,t){var i=crmjs.navItems.get(n);i.setLabel(t)},getVisible:function(n){var t=crmjs.navItems.get(n);t.getVisible()},setVisible:function(n,t){var i=crmjs.navItems.get(n);i.setVisible(t)}},events:{refresh:function(t,i,r){n.Page.data.refresh(save).then(i,r)},save:function(t,i){n.Page.data.save().then(t,i)},saveAndClose:function(){n.Page.data.entity.save("saveandclose")},saveAndNew:function(){n.Page.data.entity.save("saveandnew")}},notificatons:{set:function(t,i,r){n.Page.ui.setFormNotification(t,i,r)},clear:function(t){n.Page.ui.clearFormNotification(t)},fieldSet:function(n,t,i){var r=crmjs.attr.getControl(n);r.setNotification(t,i)},fieldClear:function(n,t){var i=crmjs.attr.getControl(n);i.clearNotification(t)}},iframe:{getSrc:function(n){var t=crmjs.attr.getControl(n);return t.getSrc()},setSrc:function(n,t){var i=crmjs.attr.getControl(n);return i.setSrc(t)},get:function(){var n=crmjs.attr.getControl(iFrameName);return n.getObject()}},debug:{log:function(n){(typeof console=="undefined"||typeof console.log=="undefined")&&(console={},console.log=function(n){alert(n)});console.log("debug: "+n)}}}}();